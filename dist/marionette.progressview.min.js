/*! marionette-progressView 18-07-2013 */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["marionette","underscore"],b):a.Marionette.ProgressView=b(a.Marionette,a._)}(this,function(a,b){"use strict";var c=a.ItemView.extend({template:b.template("<div class='content'></div>"),viewIndex:0,views:[],viewContainer:".content",constructor:function(){if(a.View.prototype.constructor.apply(this,arguments),!this.views||b.isEmpty(this.views))throw new Error("Views Must Be Provided");this.options.viewContainer&&(this.viewContainer=this.options.viewContainer),this.on("render",this.showView)},showView:function(){this.currentView||(this.currentView=new this.views[this.viewIndex]),this.currentView.render(),this._initListeners(),this._appendView()},getViewCount:function(){return this.views.length},getCurrentIndex:function(){return this.viewIndex},getCurrentCompletion:function(){return 100*(this.viewIndex/this.views.length)},loadPreviousView:function(){this.viewIndex--,this._loadView()},loadNextView:function(){this.viewIndex++,this._loadView()},_loadView:function(){this._handleProgress(),this._cleanupCurrentView(),this.getViewCount()>this.viewIndex?this.showView():this._handleComplete()},_appendView:function(){this.viewContainer?this.$(this.viewContainer).append(this.currentView.$el):this.$el.append(this.currentView.$el)},_cleanupCurrentView:function(){this.currentView.close(),this.currentView=null},_initListeners:function(){this.listenTo(this.currentView,"prev:item",this.loadPreviousView,this),this.listenTo(this.currentView,"next:item",this.loadNextView,this),this.listenTo(this.currentView,"close:progress",this.close,this)},_handleProgress:function(){b.isFunction(this.onProgress)&&this.onProgress(this.getCurrentCompletion(),this.getCurrentIndex())},_handleComplete:function(){b.isFunction(this.onComplete)&&this.onComplete()}});return c});